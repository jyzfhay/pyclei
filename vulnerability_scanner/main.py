import os
import asyncio
import inquirer
from scanner import run_scanner

def main():
    templates_dir = 'templates'
    template_files = [f for f in os.listdir(templates_dir) if f.endswith('.yaml')]
    
    if not template_files:
        print("No templates found in the 'templates' directory.")
        return

    questions = [
        inquirer.List(
            'template',
            message="Which template would you like to use?",
            choices=template_files,
        ),
    ]
    answers = inquirer.prompt(questions)
    selected_template = answers['template']

    template_path = os.path.join(templates_dir, selected_template)
    asyncio.run(run_scanner([template_path]))

if __name__ == "__main__":
    main()
