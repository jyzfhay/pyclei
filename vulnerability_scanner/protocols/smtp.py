import smtplib

class SmtpScanner:
    def __init__(self, template):
        self.template = template

    def scan(self):
        host = self.template['host']
        port = self.template.get('port', 25)
        try:
            server = smtplib.SMTP(host, port, timeout=10)
            server.ehlo()
            banner = server.noop()
            server.quit()
            return banner
        except Exception as e:
            return str(e)
