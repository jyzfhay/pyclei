import json
import logging

logger = logging.getLogger(__name__)

def generate_report(results):
    report = {
        'scan_summary': {
            'total_scans': len(results),
            'vulnerabilities_found': len([res for res in results if 'Vulnerability found' in res])
        },
        'details': results
    }
    
    with open('scan_report.json', 'w') as file:
        json.dump(report, file, indent=4)
    
    logger.info("Report generated: scan_report.json")
