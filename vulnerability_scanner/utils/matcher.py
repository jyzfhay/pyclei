import re
from jsonpath_ng import parse

def match_http_response(request, response):
    if 'matchers' in request:
        for matcher in request['matchers']:
            if matcher['type'] == 'status':
                if response['status_code'] not in matcher['status']:
                    return False
            elif matcher['type'] == 'word':
                condition = matcher.get('condition', 'or')
                words = matcher['words']
                if matcher.get('part', 'body') == 'header':
                    data = response['headers']
                else:
                    data = response['body']
                
                matches = [word in data for word in words]
                if condition == 'and' and not all(matches):
                    return False
                if condition == 'or' and not any(matches):
                    return False
    return True

def match_dns_response(request, response):
    if 'matchers' in request:
        for matcher in request['matchers']:
            if matcher['type'] == 'expected_records':
                if matcher['expected_records'] not in response:
                    return False
    return True

def match_tcp_response(request, response):
    if 'matchers' in request:
        for matcher in request['matchers']:
            if matcher['type'] == 'expected_result':
                if matcher['expected_result'] != response:
                    return False
    return True

def match_udp_response(request, response):
    if 'matchers' in request:
        for matcher in request['matchers']:
            if matcher['type'] == 'expected_response':
                if matcher['expected_response'] not in response:
                    return False
    return True
