import re
from jsonpath_ng import parse  # Only keep necessary imports

def match_http_response(template, response):
    if 'status_code' in template['match']:
        if template['match']['status_code'] != response.status_code:
            return False
    if 'body_contains' in template['match']:
        if template['match']['body_contains'] not in response.text:
            return False
    if 'body_regex' in template['match']:
        if not re.search(template['match']['body_regex'], response.text):
            return False
    if 'json_path' in template['match']:
        json_data = response.json()
        json_expr = parse(template['match']['json_path'])
        if not json_expr.find(json_data):
            return False
    return True

def match_dns_response(template, response):
    if 'expected_records' in template['match']:
        if template['match']['expected_records'] not in response:
            return False
    return True

def match_tcp_response(template, response):
    if 'expected_result' in template['match']:
        if template['match']['expected_result'] != response:
            return False
    return True

def match_udp_response(template, response):
    if 'expected_response' in template['match']:
        if template['match']['expected_response'] not in response:
            return False
    return True
